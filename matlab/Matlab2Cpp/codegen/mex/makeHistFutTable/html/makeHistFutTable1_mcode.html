<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">y</span> ] = makeHistFutTable( <span class="var type1" id="S3T2U6">testm</span>,<span class="var type1" id="S4T3U7">range</span>,<span class="var type1" id="S5T3U8">dims</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="mxinfo " id="T1:U5"><span class="var type1" id="S6T1U11">ctable</span> = <span class="mxinfo " id="T1:U7"><span class="fcn" id="F2N4:B13">comptable</span> (<span class="var type1" id="S4T3U14">range</span>, <span class="var type1" id="S5T3U15">dims</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T3:U10"><span class="var type1" id="S8T3U18">ressize</span> = <span class="mxinfo " id="T3:U12"><span class="var type1" id="S6T1U20">ctable</span> (<span class="mxinfo " id="T3:U14">end</span>,<span class="mxinfo " id="T3:U15">end</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T1:U16"><span class="var type1" id="S10T1U27">HistFutTable</span> = <span class="mxinfo " id="T1:U18">zeros (<span class="var type1" id="S8T3U30">ressize</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S12T3U33">its</span> = <span class="mxinfo " id="T3:U21">1</span>:(<span class="mxinfo " id="T3:U22">size(<span class="var type1" id="S3T2U40">testm</span>,2)</span>-(<span class="mxinfo " id="T3:U24"><span class="var type1" id="S4T3U44">range</span>*<span class="mxinfo " id="T3:U26">2</span></span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="comment">%for previous and future of an agent, write event in the result matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    <span class="comment">%incrementing the value by 1 in the location corresponding to its</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">    <span class="comment">%behavior</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo " id="T2:U27"><span class="var type1" id="S14T2U48">ahist</span> = <span class="mxinfo " id="T2:U29"><span class="var type1" id="S3T2U50">testm</span>(<span class="mxinfo " id="T4:U31">1</span>,<span class="mxinfo " id="T5:U32"><span class="var type1" id="S12T3U53">its</span>:<span class="mxinfo " id="T3:U34"><span class="var type1" id="S12T3U55">its</span>+(<span class="mxinfo " id="T3:U36"><span class="var type1" id="S4T3U58">range</span>-<span class="mxinfo " id="T3:U38">1</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T6:U39">isempty (<span class="mxinfo " id="T7:U40">find (<span class="mxinfo " id="T8:U41"><span class="var type1" id="S14T2U67">ahist</span> == <span class="mxinfo " id="T3:U43">0</span></span>, 1)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">        <span class="mxinfo " id="T9:U44"><span class="var type1" id="S14T9U72">ahist</span> = <span class="mxinfo " id="T9:U46"><span class="fcn" id="F48N2:B74">compmat</span> (<span class="var type1" id="S14T2U75">ahist</span>,<span class="var type1" id="S5T3U76">dims</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">        <span class="keyword">continue</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="comment">%if there is a 0 in the history or future of an agent, that indicates </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="comment">%a break between one agent's history and the next, which is garbage</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="comment">%data and is therefore skipped. This preserves the deliniation between</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="comment">%agents</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T2:U49"><span class="var type1" id="S18T2U81">afut</span> = <span class="mxinfo " id="T2:U51"><span class="var type1" id="S3T2U83">testm</span>(<span class="mxinfo " id="T4:U53">1</span>,<span class="mxinfo " id="T9:U54"><span class="mxinfo " id="T3:U55"><span class="var type1" id="S12T3U87">its</span>+<span class="var type1" id="S4T3U88">range</span></span>:<span class="mxinfo " id="T3:U58"><span class="var type1" id="S12T3U90">its</span>+(<span class="mxinfo " id="T3:U60"><span class="mxinfo " id="T3:U61"><span class="var type1" id="S4T3U94">range</span>*<span class="mxinfo " id="T3:U63">2</span></span>-<span class="mxinfo " id="T3:U64">1</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T6:U65">isempty (<span class="mxinfo " id="T7:U66">find (<span class="mxinfo " id="T8:U67"><span class="var type1" id="S18T2U104">afut</span> == <span class="mxinfo " id="T3:U69">0</span></span>, 1)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">        <span class="mxinfo " id="T9:U70"><span class="var type1" id="S18T9U109">afut</span> = <span class="mxinfo " id="T9:U72"><span class="fcn" id="F48N2:B111">compmat</span> (<span class="var type1" id="S18T2U112">afut</span>,<span class="var type1" id="S5T3U113">dims</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">        <span class="keyword">continue</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo " id="T3:U75"><span class="var type1" id="S19T3U118">xcor</span> = <span class="mxinfo " id="T3:U77"><span class="fcn" id="F79N3:B120">compressedindex</span>(<span class="var type1" id="S14T9U121">ahist</span>,<span class="var type1" id="S6T1U122">ctable</span>,<span class="var type1" id="S4T3U123">range</span>,<span class="var type1" id="S5T3U124">dims</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T3:U82"><span class="var type1" id="S21T3U127">ycor</span> = <span class="mxinfo " id="T3:U84"><span class="fcn" id="F79N3:B129">compressedindex</span>(<span class="var type1" id="S18T9U130">afut</span>,<span class="var type1" id="S6T1U131">ctable</span>,<span class="var type1" id="S4T3U132">range</span>,<span class="var type1" id="S5T3U133">dims</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T3:U89"><span class="var type1" id="S22T3U136">prevvalue</span> = <span class="mxinfo " id="T3:U91"><span class="var type1" id="S10T1U138">HistFutTable</span>(<span class="var type1" id="S21T3U139">ycor</span>,<span class="var type1" id="S19T3U140">xcor</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo " id="T3:U95"><span class="mxinfo " id="T3:U96"><span class="var type1" id="S10T1U144">HistFutTable</span>(<span class="var type1" id="S21T3U145">ycor</span>,<span class="var type1" id="S19T3U146">xcor</span>)</span> = <span class="mxinfo " id="T3:U100"><span class="var type1" id="S22T3U148">prevvalue</span> + <span class="mxinfo " id="T3:U102">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo " id="T1:U103"><span class="var type1" id="S2T1U152">y</span> = <span class="var type1" id="S10T1U153">HistFutTable</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"></span></span>
</pre>
